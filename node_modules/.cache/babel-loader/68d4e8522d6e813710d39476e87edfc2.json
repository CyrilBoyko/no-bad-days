{"ast":null,"code":"import _regeneratorRuntime from\"/Users/a1/Desktop/app/no-bad-days-social-network-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/a1/Desktop/app/no-bad-days-social-network-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/Users/a1/Desktop/app/no-bad-days-social-network-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/a1/Desktop/app/no-bad-days-social-network-demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{stopSubmit}from\"redux-form\";import{profileAPI}from\"../api/profile-api\";var initialState={posts:[{id:1,message:'Hi, how are you?',likesCount:0},{id:2,message:'It\\'s my first post',likesCount:23}],profile:null,status:'',newPostText:''};var profileReducer=function profileReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case'SN/PROFILE/ADD-POST':{var newPost={id:state.posts.length+1,message:action.newPostText,likesCount:0};return _objectSpread({},state,{posts:[].concat(_toConsumableArray(state.posts),[newPost]),newPostText:''});}case'SN/PROFILE/SET_USER_PROFILE':{return _objectSpread({},state,{profile:action.profile});}case'SN/PROFILE/SET_STATUS':{return _objectSpread({},state,{status:action.status});}case'SN/PROFILE/DELETE_POST':{return _objectSpread({},state,{posts:state.posts.filter(function(p){return p.id!==action.postId;})});}case'SN/PROFILE/SAVE_PHOTO_SUCCESS':{return _objectSpread({},state,{profile:_objectSpread({},state.profile,{photos:action.photos})});}default:return state;}};export var actions={addPostActionCreator:function addPostActionCreator(newPostText){return{type:'SN/PROFILE/ADD-POST',newPostText:newPostText};},setUserProfile:function setUserProfile(profile){return{type:'SN/PROFILE/SET_USER_PROFILE',profile:profile};},deletePost:function deletePost(postId){return{type:'SN/PROFILE/DELETE_POST',postId:postId};},savePhotoSuccess:function savePhotoSuccess(photos){return{type:'SN/PROFILE/SAVE_PHOTO_SUCCESS',photos:photos};},setStatus:function setStatus(status){return{type:'SN/PROFILE/SET_STATUS',status:status};}};export var getUserProfile=function getUserProfile(userId){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return profileAPI.getProfile(userId);case 2:data=_context.sent;dispatch(actions.setUserProfile(data));case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var getStatus=function getStatus(userId){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return profileAPI.getStatus(userId);case 2:data=_context2.sent;dispatch(actions.setStatus(data));case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var updateStatus=function updateStatus(status){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return profileAPI.updateStatus(status);case 3:data=_context3.sent;if(data.resultCode===0){dispatch(actions.setStatus(status));}_context3.next=9;break;case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](0);case 9:case\"end\":return _context3.stop();}}},_callee3,null,[[0,7]]);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var savePhoto=function savePhoto(file){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch){var data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return profileAPI.savePhoto(file);case 2:data=_context4.sent;if(data.resultCode===0){dispatch(actions.savePhotoSuccess(data.data.photos));}case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export var saveProfile=function saveProfile(profile){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(dispatch,getState){var userId,data;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:userId=getState().auth.userId;_context5.next=3;return profileAPI.saveProfile(profile);case 3:data=_context5.sent;if(!(data.resultCode===0)){_context5.next=12;break;}if(!(userId!=null)){_context5.next=9;break;}dispatch(getUserProfile(userId));_context5.next=10;break;case 9:throw new Error(\"userId can't be null\");case 10:_context5.next=14;break;case 12:dispatch(stopSubmit(\"edit-profile\",{_error:data.messages[0]}));return _context5.abrupt(\"return\",Promise.reject(data.messages[0]));case 14:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x5,_x6){return _ref5.apply(this,arguments);};}();};export default profileReducer;","map":{"version":3,"sources":["/Users/a1/Desktop/app/no-bad-days-social-network-demo/src/redux/profile-reducer.ts"],"names":["stopSubmit","profileAPI","initialState","posts","id","message","likesCount","profile","status","newPostText","profileReducer","state","action","type","newPost","length","filter","p","postId","photos","actions","addPostActionCreator","setUserProfile","deletePost","savePhotoSuccess","setStatus","getUserProfile","userId","dispatch","getProfile","data","getStatus","updateStatus","resultCode","savePhoto","file","saveProfile","getState","auth","Error","_error","messages","Promise","reject"],"mappings":"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","sourcesContent":["import {FormAction, stopSubmit} from \"redux-form\";\nimport {PhotosType, PostType, ProfileType} from \"../types/types\";\nimport {profileAPI} from \"../api/profile-api\";\nimport {BaseThunkType, InferActionsTypes} from \"./redux-store\";\n\nlet initialState = {\n    posts: [\n        {id: 1, message: 'Hi, how are you?', likesCount: 0},\n        {id: 2, message: 'It\\'s my first post', likesCount: 23}\n    ] as Array<PostType>,\n    profile: null as ProfileType | null,\n    status: '',\n    newPostText: ''\n};\n\nconst profileReducer = (state = initialState, action: ActionsType): InitialStateType => {\n    switch (action.type) {\n        case 'SN/PROFILE/ADD-POST': {\n            let newPost = {\n                id: state.posts.length + 1,\n                message: action.newPostText,\n                likesCount: 0\n            };\n            return {\n                ...state,\n                posts: [...state.posts, newPost],\n                newPostText: ''\n            };\n        }\n        case 'SN/PROFILE/SET_USER_PROFILE': {\n            return {\n                ...state,\n                profile: action.profile\n            }\n        }\n        case 'SN/PROFILE/SET_STATUS': {\n            return {\n                ...state,\n                status: action.status\n            }\n        }\n        case 'SN/PROFILE/DELETE_POST': {\n            return {\n                ...state, posts: state.posts.filter(p => p.id !== action.postId)\n            }\n        }\n        case 'SN/PROFILE/SAVE_PHOTO_SUCCESS': {\n            return {\n                ...state, profile: {...state.profile, photos: action.photos} as ProfileType\n            }\n        }\n        default:\n            return state;\n    }\n};\n\nexport const actions = {\n    addPostActionCreator: (newPostText: string) => ({type: 'SN/PROFILE/ADD-POST', newPostText} as const),\n    setUserProfile: (profile: ProfileType) => ({type: 'SN/PROFILE/SET_USER_PROFILE', profile} as const),\n    deletePost: (postId: number) => ({type: 'SN/PROFILE/DELETE_POST', postId} as const),\n    savePhotoSuccess: (photos: PhotosType) => ({type: 'SN/PROFILE/SAVE_PHOTO_SUCCESS', photos} as const),\n    setStatus: (status: string) => ({type: 'SN/PROFILE/SET_STATUS', status} as const)\n};\n\nexport const getUserProfile = (userId: number): ThunkType => async (dispatch) => {\n    const data = await profileAPI.getProfile(userId);\n    dispatch(actions.setUserProfile(data));\n};\n\nexport const getStatus = (userId: number): ThunkType => async (dispatch) => {\n    const data = await profileAPI.getStatus(userId);\n    dispatch(actions.setStatus(data));\n};\n\nexport const updateStatus = (status: string): ThunkType => async (dispatch) => {\n    try {\n        const data = await profileAPI.updateStatus(status);\n        if (data.resultCode === 0) {\n            dispatch(actions.setStatus(status));\n        }\n    } catch (error) {\n        //\n    }\n};\n\nexport const savePhoto = (file: File): ThunkType => async (dispatch) => {\n    const data = await profileAPI.savePhoto(file);\n    if (data.resultCode === 0) {\n        dispatch(actions.savePhotoSuccess(data.data.photos));\n    }\n};\n\nexport const saveProfile = (profile: ProfileType): ThunkType => async (dispatch, getState) => {\n    const userId = getState().auth.userId;\n    const data = await profileAPI.saveProfile(profile);\n    if (data.resultCode === 0) {\n        if (userId != null) {\n            dispatch(getUserProfile(userId));\n        } else {\n            throw new Error(\"userId can't be null\")\n        }\n    } else {\n        dispatch(stopSubmit(\"edit-profile\", {_error: data.messages[0]}));\n        return Promise.reject(data.messages[0]);\n    }\n};\n\nexport default profileReducer;\n\nexport type InitialStateType = typeof initialState\n\ntype ActionsType = InferActionsTypes<typeof actions>\n\ntype ThunkType = BaseThunkType<ActionsType | FormAction>"]},"metadata":{},"sourceType":"module"}